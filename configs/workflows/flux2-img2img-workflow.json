{
  "_comment": "Flux 2 Dev Image-to-Image Workflow for garment reference-guided generation. Based on official Comfy-Org template with ReferenceLatent node. Adapted for dual RTX 6000 Ada with our model files.",
  "last_node_id": 30,
  "last_link_id": 40,
  "nodes": [
    {
      "id": 1,
      "type": "UNETLoader",
      "pos": [-1000, 0],
      "size": [300, 82],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [1]
        }
      ],
      "properties": {
        "Node name for S&R": "UNETLoader"
      },
      "widgets_values": [
        "flux2_dev_fp8mixed.safetensors",
        "default"
      ],
      "title": "Load Diffusion Model"
    },
    {
      "id": 2,
      "type": "CLIPLoader",
      "pos": [-1000, 140],
      "size": [300, 106],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "links": [2]
        }
      ],
      "properties": {
        "Node name for S&R": "CLIPLoader"
      },
      "widgets_values": [
        "mistral_3_small_flux2_fp8.safetensors",
        "flux2",
        "default"
      ],
      "title": "Load Mistral Text Encoder"
    },
    {
      "id": 3,
      "type": "VAELoader",
      "pos": [-1000, 310],
      "size": [300, 60],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "VAE",
          "type": "VAE",
          "links": [3, 4]
        }
      ],
      "properties": {
        "Node name for S&R": "VAELoader"
      },
      "widgets_values": [
        "flux2-vae.safetensors"
      ],
      "title": "Load Flux 2 VAE"
    },
    {
      "id": 4,
      "type": "LoadImage",
      "pos": [-1000, 440],
      "size": [274, 314],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [10, 11]
        },
        {
          "name": "MASK",
          "type": "MASK",
          "links": null
        }
      ],
      "properties": {
        "Node name for S&R": "LoadImage"
      },
      "widgets_values": [
        "reference_garment.png",
        "image"
      ],
      "title": "Load Reference Image (Garment Photo)"
    },
    {
      "id": 5,
      "type": "ImageScaleToTotalPixels",
      "pos": [-650, 440],
      "size": [270, 106],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [
        {
          "name": "image",
          "type": "IMAGE",
          "link": 10
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [12]
        }
      ],
      "properties": {
        "Node name for S&R": "ImageScaleToTotalPixels"
      },
      "widgets_values": [
        "lanczos",
        1.0,
        1
      ],
      "_comment": "Scales reference image to approximately 1 megapixel. Adjust megapixels value for larger output (up to 4.0 for Flux 2)."
    },
    {
      "id": 6,
      "type": "VAEEncode",
      "pos": [-650, 600],
      "size": [200, 46],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [
        {
          "name": "pixels",
          "type": "IMAGE",
          "link": 12
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 3
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [13]
        }
      ],
      "properties": {
        "Node name for S&R": "VAEEncode"
      },
      "widgets_values": [],
      "title": "Encode Reference to Latent"
    },
    {
      "id": 7,
      "type": "GetImageSize",
      "pos": [-650, 700],
      "size": [140, 66],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [
        {
          "name": "image",
          "type": "IMAGE",
          "link": 11
        }
      ],
      "outputs": [
        {
          "name": "width",
          "type": "INT",
          "links": [14, 15]
        },
        {
          "name": "height",
          "type": "INT",
          "links": [16, 17]
        },
        {
          "name": "batch_size",
          "type": "INT",
          "links": null
        }
      ],
      "properties": {
        "Node name for S&R": "GetImageSize"
      },
      "widgets_values": [],
      "title": "Get Reference Dimensions"
    },
    {
      "id": 10,
      "type": "CLIPTextEncode",
      "pos": [-600, 0],
      "size": [420, 180],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 2
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "links": [20]
        }
      ],
      "properties": {
        "Node name for S&R": "CLIPTextEncode"
      },
      "widgets_values": [
        "A chrome mannequin wearing the exact garment from the reference image. Studio lighting, seamless white backdrop. The garment should match the reference perfectly: same fabric, color, drape, and construction details. Professional fashion photography, editorial catalog style. Keep the garment."
      ],
      "title": "Edit Prompt (describe changes to reference)",
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 11,
      "type": "FluxGuidance",
      "pos": [-600, 240],
      "size": [320, 58],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "conditioning",
          "type": "CONDITIONING",
          "link": 20
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "links": [21]
        }
      ],
      "properties": {
        "Node name for S&R": "FluxGuidance"
      },
      "widgets_values": [
        4.0
      ],
      "title": "Flux Guidance",
      "color": "#233",
      "bgcolor": "#355"
    },
    {
      "id": 12,
      "type": "ReferenceLatent",
      "pos": [-200, 200],
      "size": [204, 46],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [
        {
          "name": "conditioning",
          "type": "CONDITIONING",
          "link": 21
        },
        {
          "name": "latent",
          "type": "LATENT",
          "link": 13
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "links": [22]
        }
      ],
      "properties": {
        "Node name for S&R": "ReferenceLatent"
      },
      "widgets_values": [],
      "title": "Reference Latent (connects garment image to conditioning)",
      "_comment": "This is the key node for img2img in Flux 2. It injects the reference image latent into the conditioning pipeline, guiding generation to match the reference."
    },
    {
      "id": 15,
      "type": "BasicGuider",
      "pos": [100, 0],
      "size": [220, 46],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 1
        },
        {
          "name": "conditioning",
          "type": "CONDITIONING",
          "link": 22
        }
      ],
      "outputs": [
        {
          "name": "GUIDER",
          "type": "GUIDER",
          "links": [25]
        }
      ],
      "properties": {
        "Node name for S&R": "BasicGuider"
      },
      "widgets_values": []
    },
    {
      "id": 16,
      "type": "RandomNoise",
      "pos": [100, 100],
      "size": [220, 82],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "NOISE",
          "type": "NOISE",
          "links": [26]
        }
      ],
      "properties": {
        "Node name for S&R": "RandomNoise"
      },
      "widgets_values": [
        42,
        "randomize"
      ]
    },
    {
      "id": 17,
      "type": "KSamplerSelect",
      "pos": [100, 240],
      "size": [220, 58],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "SAMPLER",
          "type": "SAMPLER",
          "links": [27]
        }
      ],
      "properties": {
        "Node name for S&R": "KSamplerSelect"
      },
      "widgets_values": [
        "euler"
      ]
    },
    {
      "id": 18,
      "type": "Flux2Scheduler",
      "pos": [100, 360],
      "size": [220, 106],
      "flags": {},
      "order": 13,
      "mode": 0,
      "inputs": [
        {
          "name": "width",
          "type": "INT",
          "link": 14
        },
        {
          "name": "height",
          "type": "INT",
          "link": 16
        }
      ],
      "outputs": [
        {
          "name": "SIGMAS",
          "type": "SIGMAS",
          "links": [28]
        }
      ],
      "properties": {
        "Node name for S&R": "Flux2Scheduler"
      },
      "widgets_values": [
        20,
        1248,
        832
      ],
      "_comment": "Width and height are dynamically set from the reference image dimensions."
    },
    {
      "id": 19,
      "type": "EmptyFlux2LatentImage",
      "pos": [100, 530],
      "size": [270, 106],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [
        {
          "name": "width",
          "type": "INT",
          "link": 15
        },
        {
          "name": "height",
          "type": "INT",
          "link": 17
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [29]
        }
      ],
      "properties": {
        "Node name for S&R": "EmptyFlux2LatentImage"
      },
      "widgets_values": [
        1248,
        832,
        1
      ],
      "_comment": "Dimensions dynamically match reference image."
    },
    {
      "id": 20,
      "type": "SamplerCustomAdvanced",
      "pos": [420, 0],
      "size": [270, 124],
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [
        {
          "name": "noise",
          "type": "NOISE",
          "link": 26
        },
        {
          "name": "guider",
          "type": "GUIDER",
          "link": 25
        },
        {
          "name": "sampler",
          "type": "SAMPLER",
          "link": 27
        },
        {
          "name": "sigmas",
          "type": "SIGMAS",
          "link": 28
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 29
        }
      ],
      "outputs": [
        {
          "name": "output",
          "type": "LATENT",
          "links": [30]
        },
        {
          "name": "denoised_output",
          "type": "LATENT",
          "links": null
        }
      ],
      "properties": {
        "Node name for S&R": "SamplerCustomAdvanced"
      },
      "widgets_values": []
    },
    {
      "id": 21,
      "type": "VAEDecode",
      "pos": [750, 0],
      "size": [210, 46],
      "flags": {},
      "order": 16,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 30
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 4
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [31]
        }
      ],
      "properties": {
        "Node name for S&R": "VAEDecode"
      },
      "widgets_values": []
    },
    {
      "id": 22,
      "type": "SaveImage",
      "pos": [1020, 0],
      "size": [470, 470],
      "flags": {},
      "order": 17,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 31
        }
      ],
      "outputs": [],
      "properties": {
        "Node name for S&R": "SaveImage"
      },
      "widgets_values": [
        "Flux2_Img2Img"
      ]
    }
  ],
  "links": [
    [1, 1, 0, 15, 0, "MODEL"],
    [2, 2, 0, 10, 0, "CLIP"],
    [3, 3, 0, 6, 1, "VAE"],
    [4, 3, 0, 21, 1, "VAE"],
    [10, 4, 0, 5, 0, "IMAGE"],
    [11, 4, 0, 7, 0, "IMAGE"],
    [12, 5, 0, 6, 0, "IMAGE"],
    [13, 6, 0, 12, 1, "LATENT"],
    [14, 7, 0, 18, 1, "INT"],
    [15, 7, 0, 19, 0, "INT"],
    [16, 7, 1, 18, 2, "INT"],
    [17, 7, 1, 19, 1, "INT"],
    [20, 10, 0, 11, 0, "CONDITIONING"],
    [21, 11, 0, 12, 0, "CONDITIONING"],
    [22, 12, 0, 15, 1, "CONDITIONING"],
    [25, 15, 0, 20, 1, "GUIDER"],
    [26, 16, 0, 20, 0, "NOISE"],
    [27, 17, 0, 20, 2, "SAMPLER"],
    [28, 18, 0, 20, 3, "SIGMAS"],
    [29, 19, 0, 20, 4, "LATENT"],
    [30, 20, 0, 21, 0, "LATENT"],
    [31, 21, 0, 22, 0, "IMAGE"]
  ],
  "groups": [
    {
      "title": "Model Loaders",
      "bounding": [-1020, -80, 340, 470],
      "color": "#3f789e"
    },
    {
      "title": "Reference Image Input",
      "bounding": [-1020, 380, 740, 420],
      "color": "#8e4585"
    },
    {
      "title": "Prompt & Reference Conditioning",
      "bounding": [-620, -80, 560, 400],
      "color": "#3f789e"
    },
    {
      "title": "Sampling",
      "bounding": [80, -80, 640, 750],
      "color": "#3f789e"
    }
  ],
  "config": {},
  "extra": {
    "manual_config": {
      "usage_notes": [
        "1. Place your reference garment image in ComfyUI/input/ directory",
        "2. Update the LoadImage node (id:4) to point to your garment photo",
        "3. Edit the prompt to describe the desired output scene",
        "4. Use 'Keep the garment' or 'Keep the face' in prompt to preserve reference elements",
        "5. FluxGuidance=4.0 is balanced; lower (2.0) for more faithful reference, higher (6.0) for more creative",
        "6. The ReferenceLatent node is the key -- it injects the reference image into conditioning",
        "7. Dimensions automatically match reference image via GetImageSize node"
      ],
      "fashion_prompt_templates": {
        "chrome_mannequin": "A chrome mannequin wearing the exact garment from the reference image. Studio lighting, seamless white backdrop. Professional fashion photography, editorial catalog style. Keep the garment.",
        "model_editorial": "A fashion model wearing the garment from the reference image, photographed in an editorial style. Soft directional lighting, neutral background. High-end fashion photography. Keep the garment details.",
        "lifestyle_context": "The garment from the reference image worn by a model in an urban cafe setting. Natural window light, warm tones. Lifestyle fashion photography. Keep the garment.",
        "detail_closeup": "Close-up detail shot of the garment from the reference image. Macro lens, fabric texture visible. Studio lighting with fill. Keep the garment construction details."
      }
    }
  },
  "version": 0.4
}
