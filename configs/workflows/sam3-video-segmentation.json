{
  "_workflow_info": {
    "title": "SAM3D Depth-Based Segmentation Pipeline",
    "description": "Uses SAM3D_DepthEstimate to generate depth masks from input images. NOTE: No SAM/SAM2/SAM3 segmentation nodes are installed. This workflow uses the SAM3D depth model as a proxy for segmentation. For true SAM-based segmentation (text-prompted or point-based), install ComfyUI-SAM2 or ComfyUI-Segment-Anything.",
    "missing_nodes": [
      "SAM2ModelLoader (ComfyUI-SAM2)",
      "SAM2Segmentation (ComfyUI-SAM2)",
      "SAM2VideoSegmentation (ComfyUI-SAM2)",
      "GroundingDINOModelLoader (ComfyUI-GroundingDINO)",
      "GroundingDINOSAMSegment (ComfyUI-GroundingDINO)",
      "Florence2 (ComfyUI-Florence2)"
    ],
    "available_approach": "SAM3D depth estimation produces a depth_mask output that can threshold objects by depth. For multi-object scene segmentation, use SAM3DSceneGenerate which accepts batched masks.",
    "version": "1.0.0",
    "created": "2026-02-28"
  },
  "last_node_id": 12,
  "last_link_id": 14,
  "nodes": [
    {
      "id": 1,
      "type": "LoadImage",
      "pos": [50, 100],
      "size": [300, 150],
      "properties": {
        "Node name for S&R": "LoadImage"
      },
      "widgets_values": ["example.png"],
      "inputs": [],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [1, 6],
          "slot_index": 0
        },
        {
          "name": "MASK",
          "type": "MASK",
          "links": [],
          "slot_index": 1
        }
      ]
    },
    {
      "id": 2,
      "type": "LoadSAM3DModel",
      "pos": [50, 350],
      "size": [350, 200],
      "properties": {
        "Node name for S&R": "LoadSAM3DModel"
      },
      "widgets_values": [false, true, "bfloat16", "moge2"],
      "inputs": [],
      "outputs": [
        {
          "name": "depth_model",
          "type": "SAM3D_MODEL",
          "links": [2],
          "slot_index": 0
        },
        {
          "name": "generator",
          "type": "SAM3D_MODEL",
          "links": [8],
          "slot_index": 1
        },
        {
          "name": "slat_decoder_gs",
          "type": "SAM3D_MODEL",
          "links": [],
          "slot_index": 2
        },
        {
          "name": "slat_decoder_mesh",
          "type": "SAM3D_MODEL",
          "links": [10],
          "slot_index": 3
        }
      ]
    },
    {
      "id": 3,
      "type": "SAM3D_DepthEstimate",
      "pos": [450, 200],
      "size": [350, 200],
      "properties": {
        "Node name for S&R": "SAM3D_DepthEstimate"
      },
      "widgets_values": [],
      "inputs": [
        {
          "name": "depth_model",
          "type": "SAM3D_MODEL",
          "link": 2
        },
        {
          "name": "image",
          "type": "IMAGE",
          "link": 1
        }
      ],
      "outputs": [
        {
          "name": "intrinsics",
          "type": "SAM3D_INTRINSICS",
          "links": [],
          "slot_index": 0
        },
        {
          "name": "pointmap_path",
          "type": "STRING",
          "links": [9],
          "slot_index": 1
        },
        {
          "name": "pointcloud_ply",
          "type": "STRING",
          "links": [5],
          "slot_index": 2
        },
        {
          "name": "depth_mask",
          "type": "MASK",
          "links": [3, 7, 11],
          "slot_index": 3
        }
      ]
    },
    {
      "id": 4,
      "type": "ThresholdMask",
      "pos": [900, 100],
      "size": [250, 100],
      "properties": {
        "Node name for S&R": "ThresholdMask"
      },
      "widgets_values": [0.5],
      "inputs": [
        {
          "name": "mask",
          "type": "MASK",
          "link": 3
        }
      ],
      "outputs": [
        {
          "name": "MASK",
          "type": "MASK",
          "links": [4, 13],
          "slot_index": 0
        }
      ]
    },
    {
      "id": 5,
      "type": "MaskToImage",
      "pos": [1250, 50],
      "size": [200, 80],
      "properties": {
        "Node name for S&R": "MaskToImage"
      },
      "widgets_values": [],
      "inputs": [
        {
          "name": "mask",
          "type": "MASK",
          "link": 4
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [12],
          "slot_index": 0
        }
      ]
    },
    {
      "id": 6,
      "type": "SaveImage",
      "pos": [1500, 50],
      "size": [300, 200],
      "properties": {
        "Node name for S&R": "SaveImage"
      },
      "widgets_values": ["sam3d_segmentation_mask"],
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 12
        }
      ],
      "outputs": []
    },
    {
      "id": 7,
      "type": "MaskPreview",
      "pos": [900, 300],
      "size": [250, 200],
      "properties": {
        "Node name for S&R": "MaskPreview"
      },
      "widgets_values": [],
      "inputs": [
        {
          "name": "mask",
          "type": "MASK",
          "link": 7
        }
      ],
      "outputs": []
    },
    {
      "id": 8,
      "type": "SAM3D_PreviewPointCloud",
      "pos": [900, 550],
      "size": [300, 100],
      "properties": {
        "Node name for S&R": "SAM3D_PreviewPointCloud"
      },
      "widgets_values": [""],
      "inputs": [
        {
          "name": "file_path",
          "type": "STRING",
          "link": 5,
          "widget": {
            "name": "file_path"
          }
        }
      ],
      "outputs": []
    },
    {
      "id": 9,
      "type": "SaveImage",
      "pos": [1500, 300],
      "size": [300, 200],
      "properties": {
        "Node name for S&R": "SaveImage"
      },
      "widgets_values": ["sam3d_input_image"],
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 6
        }
      ],
      "outputs": []
    },
    {
      "id": 10,
      "type": "SAM3DGenerateSLAT",
      "pos": [1250, 600],
      "size": [400, 350],
      "properties": {
        "Node name for S&R": "SAM3DGenerateSLAT"
      },
      "widgets_values": [42, 12, 7.5, 0.0, 12, 5.0, false],
      "inputs": [
        {
          "name": "generator",
          "type": "SAM3D_MODEL",
          "link": 8
        },
        {
          "name": "image",
          "type": "IMAGE",
          "link": null
        },
        {
          "name": "mask",
          "type": "MASK",
          "link": 13
        },
        {
          "name": "pointmap_path",
          "type": "STRING",
          "link": 9,
          "widget": {
            "name": "pointmap_path"
          }
        }
      ],
      "outputs": [
        {
          "name": "slat_path",
          "type": "STRING",
          "links": [14],
          "slot_index": 0
        },
        {
          "name": "debug_preprocessed",
          "type": "IMAGE",
          "links": [],
          "slot_index": 1
        }
      ]
    },
    {
      "id": 11,
      "type": "SAM3DMeshDecode",
      "pos": [1750, 600],
      "size": [350, 200],
      "properties": {
        "Node name for S&R": "SAM3DMeshDecode"
      },
      "widgets_values": [true, 0.95],
      "inputs": [
        {
          "name": "slat_decoder_mesh",
          "type": "SAM3D_MODEL",
          "link": 10
        },
        {
          "name": "slat",
          "type": "STRING",
          "link": 14,
          "widget": {
            "name": "slat"
          }
        }
      ],
      "outputs": [
        {
          "name": "glb_filepath",
          "type": "STRING",
          "links": [],
          "slot_index": 0
        }
      ]
    }
  ],
  "links": [
    [1, 1, 0, 3, 1, "IMAGE"],
    [2, 2, 0, 3, 0, "SAM3D_MODEL"],
    [3, 3, 3, 4, 0, "MASK"],
    [4, 4, 0, 5, 0, "MASK"],
    [5, 3, 2, 8, 0, "STRING"],
    [6, 1, 0, 9, 0, "IMAGE"],
    [7, 3, 3, 7, 0, "MASK"],
    [8, 2, 1, 10, 0, "SAM3D_MODEL"],
    [9, 3, 1, 10, 3, "STRING"],
    [10, 2, 3, 11, 0, "SAM3D_MODEL"],
    [11, 3, 3, 10, 2, "MASK"],
    [12, 5, 0, 6, 0, "IMAGE"],
    [13, 4, 0, 10, 2, "MASK"],
    [14, 10, 0, 11, 1, "STRING"]
  ],
  "groups": [
    {
      "title": "Step 1: Load Input Image",
      "bounding": [30, 50, 350, 270],
      "color": "#3f789e"
    },
    {
      "title": "Step 2: SAM3D Depth + Mask Estimation",
      "bounding": [420, 50, 420, 500],
      "color": "#2a363b"
    },
    {
      "title": "Step 3: Threshold & Export Mask",
      "bounding": [870, 30, 700, 520],
      "color": "#4a7a4a"
    },
    {
      "title": "Step 4: Optional 3D Reconstruction",
      "bounding": [1220, 560, 920, 430],
      "color": "#7a4a7a"
    }
  ],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.8,
      "offset": [0, 0]
    }
  },
  "version": 0.4
}